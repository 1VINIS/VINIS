// قائمة المعرفات المسموح لها (يمكنك زيادتها)
const AUTHORIZED_KEYS = [
    "1545725305",
    "1546260521",
    "1547887339",
    "1548248821",
    "1547918139",
    "1548197335",
    "1547862235",
    "1548636117",
    "1548065285",
    "1548582937",
    "1548581341",
    "1548604161",
    "1548303573",
    "1548260723",
    "1548635405",
    "1508041039",
    "1548028041",
    "1548578795",
    "1548291405",
    "1548235047",
    "1548300469",
    "1547948349",
    "1548267755",
    "1548259591",
    "1547945183",
    "1548102391",
    "1547940575",
    "1548206927",
    "1548252097",
    "1045236407",
    "1486602497",
    "1546964449",
    "1547678571",
    "1547712747",
    "1548216615",
    "1547905731",
    "1547988273",
    "1547968455",
    "1547973201",
    "1547922671",
    "1548062587",
    "1547962535",
    "1547662407",
    "1547875669",
    "1547871749",
    "1547923911",
    "1548063115",
    "1547851119",
    "1547626215",
    "1547874411",
    "1547750585",
    "1547962135",
    "1547828477",
    "1547953203",
    "1547916621",
    "1547888239",
    "1547884443",
    "1547738089",
    "1547851773",
    "1547788297",
    "1547800523",
    "1547760975",
    "1547131639",
    "1547135763",
    "1547786931",
    "1547635569",
    "1546654575",
    "1547705749",
    "1547752445",
    "1547668477",
    "1547428659",
    "1547681735",
    "1547187601",
    "1547693785",
    "1546426113",
    "1547565867",
    "1547735569",
    "1547710601",
    "1547693289",
    "1547755319",
    "1547652137",
    "1547626215",
    "1544391141",
    "1547607687",
    "1547615081",
    "1547681959",
    "1547628139",
    "1547676505",
    "1547077433",
    "1547568801",
    "1546787275",
    "1547081885",
    "1541560765",
    "1547139313",
    "1547518557",
    "1547483529",
    "1547606083",
    "1530793049",
    "1547102621",
    "1547589293",
    "1547583401",
    "1547131503",
    "1547580499",
    "1547573743",
    "1547525489",
    "1547030295",
    "1547581927",
    "1547534149",
    "1547567257",
    "1546809641",
    "1547518607",
    "1546854179",
    "1547223267",
    "1547529251",
    "1547493299",
    "1534485811",
    "1547483399",
    "1547495639",
    "1546800099",
    "1547487087",
    "1547487339",
    "1547149389",
    "1547484259",
    "1547504757",
    "1547455673",
    "1547188577",
    "1546510915",
    "1547112679",
    "1480191121",
    "1547456151",
    "1546876511",
    "1481988039",
    "1546573367",
    "1547045181",
    "1547335411",
    "1546745649",
    "1546490481",
    "1546722485",
    "1547035239",
    "1546900019",
    "1547064701",
    "1546809641",
    "1546993579",
    "1547070485",
    "1546655241",
    "1546592721",
    "1546936973",
    "1546940521",
    "1546930133",
    "1546824155",
    "1546546791",
    "1545655895",
    "1546966913",
    "1546553439",
    "1546482149",
    "1546712013",
    "1546494565",
    "1546764787",
    "1546563459",
    "1546843047",
    "1546469005",
    "1546739535",
    "1546059173",
    "1545771511",
    "1545648061",
    "1546494647",
    "1546599869",
    "1545729811",
    "1546362957",
    "1546555263",
    "1546625497",
    "1546431825",
    "1546456609",
    "1546468807",
    "1546339389",
    "1546337899",
    "1546569203",
    "1546545267",
    "1546413237",
    "1546565855",
    "1546524035",
    "1545763805",
    "1546286617",
    "1546529643",
    "1546503137",
    "1545662773",
    "1546271359",
    "1546529165",
    "1545656313",
    "1545647467",
    "1546276805",
    "1545653585",
    "1546407617",
    "1546411789",
    "1546435923",
    "1546413155",
    "1537348743",
    "1546483579",
    "1546248707",
    "1546322129",
    "1546297743",
    "1546242699",
    "1546209585",
    "1545769725",
    "1546231287",
    "1546277899",
    "1546218459",
    "1546238775",
    "1546159189",
    "1546221729",
    "1546146175",
    "1546256335",
    "1546161193",
    "1546121577",
    "1546201627",
    "1546215593",
    "1545657187",
    "1545628487",
    "1546132983",
    "1546188265",
    "1545675885",
    "1546117927",
    "1543938121",
    "1546125681",
    "1546056131",
    "1546083605",
    "1545661731",
    "1546023491",
    "1545670149",
    "1546055919",
    "1546022673",
    "1546090089",
    "1546051497",
    "1546011669",
    "1545675695",
    "1545665213",
    "1545691541",
    "1545686619",
    "1545689959",
    "1545660791",
    "1545699275",
    "1545702685",
    "1545691627",
    "1545708061",
    "1545711535",
    "1545704445",
    "1545735237",
    "1545725775",
    "1545757863",
    "1545751023",
    "1545753341",
    "1545762037",
    "1545764629",
    "1546124597",
    "1545712619",
    "1545650063",
    "1545989379",
    "1546014769",
];

function limitInput(el) {
    if(el.value.length > 10) el.value = el.value.slice(0, 10);
    document.getElementById('char-count').innerText = el.value.length + "/10";
}

function initiateAuth() {
    const idVal = document.getElementById('id-field').value;
    
    if(idVal.length !== 10) {
        alert("خطأ: يرجى إدخال المعرف المكون من 10 أرقام كاملاً.");
        return;
    }

    // إظهار نافذة التحليل
    const modal = document.getElementById('processingModal');
    modal.style.display = 'flex';
    
    runSimulation(idVal);
}

async function runSimulation(id) {
    const logs = [
        "> جاري الاتصال بسيرفر VINIS_CORE...",
        "> تشفير المعرف البيومتري...",
        "> فحص الصلاحيات الأمنية...",
        "> جاري مطابقة المفتاح الرقمي...",
        "> استجابة السيرفر: تم التحقق."
    ];
    
    const logBox = document.getElementById('logStream');
    const pFill = document.getElementById('pFill');
    
    for(let i = 0; i < logs.length; i++) {
        let p = document.createElement('div');
        p.innerText = logs[i];
        logBox.appendChild(p);
        
        // تحريك الـ Progress Bar
        pFill.style.width = ((i + 1) * 20) + "%";
        
        await new Promise(r => setTimeout(r, 700));
    }

    // التحقق النهائي
    setTimeout(() => {
        if(AUTHORIZED_KEYS.includes(id)) {
            window.location.href = "results.html";
        } else {
            document.getElementById('processingModal').style.display = 'none';
            document.getElementById('errorModal').style.display = 'flex';
        }
    }, 500);
}

function closeModals() {
    document.querySelectorAll('.modal').forEach(m => m.style.display = 'none');
    document.getElementById('logStream').innerHTML = "";
    document.getElementById('pFill').style.width = "0%";
}

// إنشاء خلفية "الأكواد" عشوائياً
function createCodeRain() {
    const rain = document.getElementById('codeRain');
    for(let i = 0; i < 50; i++) {
        let span = document.createElement('span');
        span.style.position = 'absolute';
        span.style.left = Math.random() * 100 + "vw";
        span.style.top = Math.random() * 100 + "vh";
        span.innerText = Math.random().toString(36).substring(2, 15);
        rain.appendChild(span);
    }
}

createCodeRain();






























































































































































































































































